:root{
  --bg:#000; --fg:#fff; --fg-dim:#cfcfcf; --stroke: rgba(255,255,255,0.12);
  --glass: rgba(255,255,255,0.04); --card-w: 900px; --bar-h: 66px;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{
  margin:0; height:100%;
  background:var(--bg); color:var(--fg);
  font-family:system-ui,"Segoe UI","Noto Naskh Arabic","Amiri","Scheherazade New",serif;
  -webkit-user-select:none; user-select:none; -webkit-touch-callout:none;
}

/* Gate */
#gate{position:fixed; inset:0; z-index:20;
  background:radial-gradient(1200px 800px at 50% 40%,#111 0%,#000 60%);
  display:grid; place-items:center; padding-bottom:env(safe-area-inset-bottom)
}
.gate-inner{text-align:center; max-width:28rem; padding:2rem}
.gate-inner h1{margin:0 0 .5rem; font-size:clamp(1.6rem,4.5vw,2.2rem)}
.gate-inner p{margin:0 0 1rem; color:var(--fg-dim)}
#startBtn,#saveUserBtn{
  background:#1f1f1f; border:1px solid #333; color:#fff;
  padding:.9rem 1.3rem; border-radius:999px; font-weight:700; cursor:pointer
}
.auth{display:flex; gap:.5rem; justify-content:center; margin:.75rem 0 1.25rem}
.auth input{background:#0f0f0f; border:1px solid #222; color:#fff; border-radius:10px; padding:.7rem 1rem; min-width:12rem}
.gate-foot{margin-top:.8rem; color:#8a8a8a; font-size:.85rem}

/* Topbar (username only) */
#topbar{
  position:fixed; top:0; left:0; right:0; height:36px; z-index:15;
  display:flex; align-items:center; padding:0 .6rem; background:linear-gradient(#000a,#0000)
}
#whoami{margin-inline-start:auto; color:var(--fg-dim); font-size:.9rem}

/* Drawer */
#drawer{
  position:fixed; inset:0 0 0 auto; width:min(92vw,420px); background:#0a0a0a; z-index:18;
  border-left:1px solid var(--stroke); transform:translateX(100%); transition:transform .25s ease;
  display:flex; flex-direction:column; padding-bottom:env(safe-area-inset-bottom)
}
#drawer.open{transform:translateX(0)}
#scrim{position:fixed; inset:0; background:#0008; backdrop-filter:blur(1px);
  opacity:0; pointer-events:none; transition:.2s; z-index:17}
#scrim.show{opacity:1; pointer-events:auto}

.drawer-sticky{position:sticky; top:0; background:#0a0a0a; z-index:1}
.drawer-head{display:flex; align-items:center; justify-content:space-between; padding:12px; border-bottom:1px solid var(--stroke)}
.drawer-search{display:flex; align-items:center; gap:8px; padding:10px 12px; border-bottom:1px solid #111}
.drawer-search input{flex:1; background:#0f0f0f; border:1px solid #222; color:#fff; border-radius:8px; padding:.6rem .75rem}

#surahList{list-style:none; margin:0; padding:0; overflow:auto; -webkit-overflow-scrolling:touch}
#surahList li{padding:.95rem 12px; border-bottom:1px solid #111; display:flex; justify-content:space-between; gap:.75rem; cursor:pointer}
#surahList li:hover{background:#111}
#surahList .en{color:#fff} .ar{color:#aaa}

/* Feed */
#feed{
  height:100svh; overflow-y:auto; scroll-snap-type:y mandatory; scroll-behavior:smooth;
  overscroll-behavior:contain; -webkit-overflow-scrolling:touch;
  padding-top:36px; padding-bottom:calc(var(--bar-h) + env(safe-area-inset-bottom));
}
#feed{ scrollbar-width:none } #feed::-webkit-scrollbar{ display:none }

/* Ayah card */
.ayah{
  position:relative; height:100svh; width:100%;
  scroll-snap-align:start; display:grid; place-items:center; padding:2rem; background:transparent
}
.ayah-inner{
  width:min(95vw,var(--card-w)); margin:auto; background:var(--glass);
  border:1px solid var(--stroke); backdrop-filter:blur(2px); border-radius:20px;
  padding:clamp(1rem,4vw,2rem);
  box-shadow:0 10px 30px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.04);
}

/* Arabic typography */
.text-ar{
  direction:rtl; text-align:center; font-weight:800;
  font-family:"Scheherazade New","Amiri","Noto Naskh Arabic",serif;
  line-height:2.2; font-size:clamp(1.6rem,4.8vw,2.8rem);
  color:#fff; word-break:break-word;
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}
.meta{ text-align:center; margin-top:.8rem; font-size:clamp(.9rem,2.5vw,1rem); color:var(--fg-dim)}

/* Tajwīd tint */
.text-ar tajweed[rule]{font-weight:800}
.text-ar tajweed[rule="ghunna"], .text-ar tajweed[rule="ikhfa"]{color:#72ff7a}
.text-ar tajweed[rule="idgham"], .text-ar tajweed[rule="idgham-without-ghunna"]{color:#66b3ff}
.text-ar tajweed[rule="iqlab"]{color:#ffd166}
.text-ar tajweed[rule="qalqalah"]{color:#ff7a7a}
.text-ar tajweed[rule="madd"]{text-decoration:underline wavy}

/* Large text mode */
body.text-lg .text-ar{ font-size:clamp(1.9rem,6vw,3.6rem); line-height:2.35 }

/* Translation under ayah */
.ayah-inner .tr{
  margin-top:.9rem;
  font-size:clamp(.95rem, 2.8vw, 1.05rem);
  line-height:1.6;
  color:#d0d0d0;
  font-family:system-ui, "Segoe UI", sans-serif;
  text-align:center;
  padding:0 .75rem;
  word-break:break-word;
}

/* FABs */
.fab{
  position:fixed; z-index:16; width:56px; height:56px; border-radius:50%;
  background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15);
  color:#fff; font-size:24px; display:grid; place-items:center; cursor:pointer; user-select:none
}
.fab-right{ right:12px; bottom:calc(var(--bar-h) + 28px + env(safe-area-inset-bottom)) }
.fab-left{ left:12px;  bottom:calc(var(--bar-h) + 28px + env(safe-area-inset-bottom)) }

/* Bottom Nav — flex cluster + moving pill */
#bottombar{
  position:fixed; left:0; right:0; bottom:0; height:var(--bar-h);
  display:flex; justify-content:center; align-items:center; gap:1.4rem;
  background:#000; border-top:1px solid var(--stroke); z-index:16;
  padding:0 14px; padding-bottom:env(safe-area-inset-bottom);
}
#pillIndicator{
  position:absolute; bottom:calc(8px + env(safe-area-inset-bottom)); left:0;
  height:40px; width:120px; transform:translateX(var(--pill-x, 0px));
  border-radius:999px; background:rgba(255,255,255,0.10);
  border:2px solid rgba(255,255,255,0.65);
  box-shadow:0 0 22px rgba(255,255,255,0.60), 0 0 44px rgba(255,255,255,0.35);
  pointer-events:none; z-index:1; transition:transform .24s ease, width .24s ease
}
#bottombar .btab{
  position:relative; z-index:2; background:transparent; border:0; color:#cfcfcf;
  cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:4px; min-height:48px; min-width:86px; padding:6px 10px; font-size:.85rem; line-height:1;
  -webkit-tap-highlight-color:transparent; transition:color .2s ease
}
#bottombar .btab span{ font-size:.75rem; color:#cfcfcf }
#bottombar .btab[aria-current="page"]{ color:#fff }
#bottombar .btab[aria-current="page"] span{ color:#fff }
#bottombar .btab[aria-current="page"] svg{ filter: drop-shadow(0 0 4px rgba(255,255,255,0.6)) }
#bottombar svg{ display:block }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  #feed{scroll-behavior:auto}
  #pillIndicator{transition:none}
}
